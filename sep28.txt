@attributes_router.post("/data_sync", status_code=200)
def export_member_attribute_dim_to_spanner(request:ExportMemberAttributeDimModel, db: Session = Depends(get_db), bq_db: Session = Depends(get_bq_db)):
    if request.country_code is None:
        return {"error":"country code is required"},400
    bq_data = GetMemberAttributeDimBq(bq_engine=bq_db, country=request.country_code, record_date=request.record_date)
    print(bq_data.__dict__)
    print(type(bq_data))
    spanner_data=[]
    for row in bq_data:
        model_obj = Attribute()
        model_obj.country=request.country_code
        data = row._asdict()
        print(data)
        attribute_name=data['member_attribute_name']
        model_obj.name = data['member_attribute_name'].replace('_', " ").title()
        model_obj.name_label = model_obj.name.replace('_', " ").title()
        member_attr_val = data['member_attr_val']
        values_json = {}
        # attributes_labels=[]
        # description=[]
        # for value in member_attr_val.split(','):
        #     if value :
        #         values_json[value] = {"label":"" , "description":""}
        # model_obj.values = values_json
        for val in member_attr_val.split(','):
            if val in attribute_info.get(request.country_code,{}).get(attribute_name,{}):
                info=attribute_info[request.country_code][attribute_name][val]
                label=info.get('label','Unknown')
                print(label)
                match = re.search(r"=\s*(.*)", label)
                if match:
                    extracted_label = match.group(1)
                else:
                    extracted_label=info.get('label',"Unknown")
                print(extracted_label)
                description=info.get('description','Unknown')
                # values_json[val] = {"label":attribute_info[val]['value_label'] , "description":attribute_info[val]['value_label']}
                # attributes_labels.append(attribute_info[val]['value_label'])
                # description.append(attribute_info[val]['value_label'])
            else:
                extracted_label='Unknown'
                description='No information available'
            values_json[val]={'label':extracted_label,'description':description}
        # if "" in attribute_info.get(request.country_code,{}).get(attribute_name,{}):
        #     info=attribute_info[request.country_code][attribute_name][""]
        #     values_json[""]["label"]=info.get('label',"unknown")
        #     values_json[""]["description"]=info.get('description','unknown')
        model_obj.values=values_json
        db.add(model_obj)
        db.commit()
        db.refresh(model_obj)
        #return model_obj.values()






      import functions_framework
from cloudevents.http.event import CloudEvent
from api.src.model.bq import get_bq_db
from api.src.util.member_attribute_query import GetMemberAttributeDimBq
import json
from api.src.model.attributes_model import Attribute
from api.src.model.base import get_db
from sqlalchemy import exc

def check_attribute_exist(value):
    try :
        session =  get_db()
        data = session.query(Attribute).filter_by(name=value).one()
        return data
    except  exc.NoResultFound:
        return False


@functions_framework.http
def ltvo_etl_process(cloud_event: CloudEvent):

    bq_db=get_bq_db()
    data = cloud_event.data.decode('utf-8')
    data = json.loads(data)
    country = data.get('country')
    
    bq_data = GetMemberAttributeDimBq(bq_engine=bq_db, country=country, record_date=data.get('record_date'))
    db = get_db()
    for row in bq_data.get_results():
        
        model_obj = Attribute()
        data = row._asdict()
        model_obj.country = country
        model_obj.name = data['member_attribute_name']
        model_obj.name_label = model_obj.name.replace('_', " ")
        model_obj.description=''
        member_attr_val = data['member_attr_val']
        values_json = {}
        for value in member_attr_val.split(','):
            if value :
                values_json[value] = {"label": "", "description":""}
        model_obj.values = values_json
        exist = check_attribute_exist(str(data['member_attribute_name']))
        if exist:
             if exist.values==model_obj.values:
                 continue
             else :
                 db.query(Attribute).filter(Attribute.name==value).update({"values" : values_json})
        else:
            db.add(model_obj)

    db.commit()

    return {"status" : 200, "message": "Data Synced Sucessfully"}

class ExportMemberAttributeDimModel(BaseModel):
    country_code: str = Field(..., title="Country Code")
    record_date: Optional[date] = Field(..., title="Date till which Record to be Fetched")












  from datetime import date, datetime
from sqlalchemy.sql import text
from ..config.env_var import settings

def get_today() -> str:
    return datetime.now()

class GetMemberAttributeDimBq(object):
    _member_attribute_tbl: str = "member_attribute_dim"
    bq_lake: str = settings.bq_lake
    def __init__(
        self,
        bq_engine,
        country,
        record_date: str = None,  # type: ignore
    ):
        self.bq_engine = bq_engine
        self.country = country.lower()
        self.record_date = get_today()
        if record_date and datetime.strptime(str(record_date), "%Y-%m-%d" ) < get_today():
            self.record_date = datetime.strptime(str(record_date), "%Y-%m-%d" )
        self.record_date = self.record_date.strftime("%Y-%m-%d")
    def __iter__(self):
        self.results=self.get_results()
        self.index=0
        return self   
    def __next__(self):
        if self.index<len(self.results):
            result=self.results[self.index]
            self.index+=1
            return result 
        else:
            raise StopIteration

    @property
    def get_member_attribute_dim_bq_table(self):
        return f"{self.bq_lake}.f_ltvo_{self.country}.{self._member_attribute_tbl}"

    @property
    def base_query(self):
        excluded_fields = {
            "us" : ' AND member_attribute_name NOT IN ("monthly_unified_weight","hh_quarterly_unified_weight","quarterly_unified_weight","hh_monthly_unified_weight","hh_weight_qty","age_gender_building_block_code","hh_weekly_unified_weight","weekly_unified_weight")',
            "it" : ' AND member_attribute_name NOT IN ("weight")',
            "fr" : ' AND member_attribute_name NOT IN ("household_id")'
        }
        query = [
            "SELECT member_attribute_name, STRING_AGG(DISTINCT member_attribute_val) as member_attr_val FROM",
            f"`{self.get_member_attribute_dim_bq_table}`",
            f'WHERE record_date < "{self.record_date}"',
        ]
        
        if self.country in excluded_fields:
            query.append(excluded_fields.get(self.country))

        query.append(f' GROUP BY member_attribute_name')
        
        return " ".join(query)
    
    def get_results(self):

        results = self.bq_engine.execute(
            text(self.base_query)
        ).fetchall()

        return results if results else []
    
    def paginate_big_query_data(bq_client, page_num, data_per_page):
        offset = (page_num - 1) * data_per_page
        query = [
                "SELECT member_attribute_name, STRING_AGG(DISTINCT member_attribute_val) as member_attr_val FROM",
                f"`{self.member_attribute_table}`",
                f'WHERE record_date < "{self.record_date}"',
                f' GROUP BY member_attribute_name',
                f'LIMIT {data_per_page}',
                f'OFFSET {offset}'
                ]
        data_obj = bq_client.execute(' '.join(query))


        return data_obj.fetchall()






























import functions_framework
from cloudevents.http.event import CloudEvent
from google.cloud import spanner_v1
from google.cloud import bigquery
import json

@functions_framework.http
def bq_to_spanner(cloud_event: CloudEvent):
    # Google Cloud Spanner configuration
    spanner_instance_id = 'your-spanner-instance-id'
    spanner_database_id = 'your-spanner-database-id'
    spanner_client = spanner_v1.Client()
    spanner_instance = spanner_client.instance(spanner_instance_id, spanner_database_id)

    # Google Cloud BigQuery configuration
    bq_project_id = 'your-bigquery-project-id'
    bq_dataset_id = 'your-bigquery-dataset-id'
    bq_table_id = 'your-bigquery-table-id'
    bq_client = bigquery.Client(project=bq_project_id)
    bq_table_ref = bq_client.dataset(bq_dataset_id).table(bq_table_id)

    # Extract data from BigQuery
    query = f"SELECT * FROM {bq_dataset_id}.{bq_table_id}"
    query_job = bq_client.query(query)
    results = query_job.result()

    # Process and insert data into Cloud Spanner
    with spanner_instance.database() as database:
        for row in results:
            data = dict(row.items())  # Adjust this mapping based on your schema
            insert_data_into_spanner(database, data)  # Implement this function

    return {"status": 200, "message": "Data Synced Successfully"}



















import functions_framework
from cloudevents.http.event import CloudEvent
from fastapi import FastAPI
import json
from sqlalchemy import exc
from datetime import date, datetime
from sqlalchemy.sql import text

app = FastAPI()

class GetMemberAttributeDimBq(object):
    _member_attribute_tbl = "member_attribute_dim"

    def __init__(self, bq_engine, country, record_date=None):
        self.bq_engine = bq_engine
        self.country = country.lower()
        self.record_date = get_today()
        if record_date and datetime.strptime(str(record_date), "%Y-%m-%d") < get_today():
            self.record_date = datetime.strptime(str(record_date), "%Y-%m-%d")
        self.record_date = self.record_date.strftime("%Y-%m-%d")

    def __iter__(self):
        self.results = self.get_results()
        self.index = 0
        return self

    def __next__(self):
        if self.index < len(self.results):
            result = self.results[self.index]
            self.index += 1
            return result
        else:
            raise StopIteration

    @property
    def get_member_attribute_dim_bq_table(self):
        return f"{self.bq_lake}.f_ltvo_{self.country}.{self._member_attribute_tbl}"

    @property
    def base_query(self):
        excluded_fields = {
            "us": ' AND member_attribute_name NOT IN ("monthly_unified_weight","hh_quarterly_unified_weight","quarterly_unified_weight","hh_monthly_unified_weight","hh_weight_qty","age_gender_building_block_code","hh_weekly_unified_weight","weekly_unified_weight")',
            "it": ' AND member_attribute_name NOT IN ("weight")',
            "fr": ' AND member_attribute_name NOT IN ("household_id")'
        }
        query = [
            "SELECT member_attribute_name, STRING_AGG(DISTINCT member_attribute_val) as member_attr_val FROM",
            f"`{self.get_member_attribute_dim_bq_table}`",
            f'WHERE record_date < "{self.record_date}"',
        ]

        if self.country in excluded_fields:
            query.append(excluded_fields.get(self.country))

        query.append(f' GROUP BY member_attribute_name')

        return " ".join(query)

    def get_results(self):
        results = self.bq_engine.execute(text(self.base_query)).fetchall()
        return results if results else []

    def paginate_big_query_data(self, page_num, data_per_page):
        offset = (page_num - 1) * data_per_page
        query = [
            "SELECT member_attribute_name, STRING_AGG(DISTINCT member_attribute_val) as member_attr_val FROM",
            f"`{self.member_attribute_table}`",
            f'WHERE record_date < "{self.record_date}"',
            f' GROUP BY member_attribute_name',
            f'LIMIT {data_per_page}',
            f'OFFSET {offset}'
        ]
        data_obj = self.bq_engine.execute(' '.join(query))
        return data_obj.fetchall()

def check_attribute_exist(value):
    try:
        session = get_db()
        data = session.query(Attribute).filter_by(name=value).one()
        return data
    except exc.NoResultFound:
        return False

@functions_framework.http
def ltvo_etl_process(cloud_event: CloudEvent):
    bq_db = get_bq_db()
    data = cloud_event.data.decode('utf-8')
    data = json.loads(data)
    country = data.get('country')
    bq_data = GetMemberAttributeDimBq(bq_engine=bq_db, country=country, record_date=data.get('record_date'))
    db = get_db()
    for row in bq_data.get_results():
        model_obj = Attribute()
        data = row._asdict()
        model_obj.country = country
        model_obj.name = data['member_attribute_name']
        model_obj.name_label = model_obj.name.replace('_', " ")
        model_obj.description = ''
        member_attr_val = data['member_attr_val']
        values_json = {}
        for value in member_attr_val.split(','):
            if value:
                values_json[value] = {"label": "", "description": ""}
        model_obj.values = values_json
        exist = check_attribute_exist(str(data['member_attribute_name']))
        if exist:
            if exist.values == model_obj.values:
                continue
            else:
                db.query(Attribute).filter(Attribute.name == value).update({"values": values_json})
        else:
            db.add(model_obj)

    db.commit()

    return {"status": 200, "message": "Data Synced Successfully"}




































Row(('works_outside_of_home_flag', 'Y'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('number_of_working_hours', '68'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '2'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '0'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '18'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '35'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '115'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '78'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '112'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '82'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '51'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '159'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '0'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('relationship_to_head_of_household_code', '4'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '151'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '134'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '147'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '116'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '73'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '83'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '57'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '118'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '125'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '17'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '79'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '103'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('number_of_working_hours', '31'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '74'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '50'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '33'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '100'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '16'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '165'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '84'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '6'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '9'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('works_outside_of_home_flag', ''), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '111'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '157'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '128'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('number_of_working_hours', '71'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '125'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('number_of_working_hours', '8'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('principal_moviegoer_code', 'Y'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '156'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '100'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '61'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '70'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('lady_of_household_flag', 'Y'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '41'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('number_of_working_hours', '34'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '16'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '77'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '160'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '10'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '33'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '150'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('number_of_working_hours', '55'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '94'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('race', '5'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '99'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '60'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('language_class_code', '4'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('language_class_code', '2'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '133'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '85'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('number_of_working_hours', '64'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '24'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('number_of_working_hours', '36'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '72'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '53'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '119'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '46'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '152'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('lady_of_household_flag', 'N'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '48'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '45'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('relationship_to_head_of_household_code', '10'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('number_of_working_hours', '98'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '50'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '72'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '37'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '20'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '122'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('number_of_working_hours', '16'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('number_of_working_hours', '80'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '57'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '114'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '95'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('nielsen_occupation_code', '6'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '65'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('education_ranges', None), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '131'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('education_ranges', '3'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('number_of_working_hours', '0'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '145'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('nielsen_occupation_code', '2'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('language_class_code', '3'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '102'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('number_of_working_hours', '43'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '30'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '80'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('number_of_working_hours', '62'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '59'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '41'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '154'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '38'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('education_ranges', '4'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '143'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '51'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('head_of_household_flag', 'Y'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('number_of_working_hours', '89'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '14'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '166'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '113'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '36'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '49'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('number_of_working_hours', '50'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '157'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('number_of_working_hours', '65'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('visitor_status_code', ''), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('number_of_working_hours', '2'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('number_of_working_hours', '47'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '81'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '75'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '112'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '86'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('number_of_working_hours', '49'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '92'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '8'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '90'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '24'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('number_of_working_hours', '77'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '64'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '54'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('number_of_working_hours', '37'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('number_of_working_hours', '72'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '126'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '44'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '150'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '92'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '2'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '48'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('frequent_moviegoer_code', 'Y'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('relationship_to_head_of_household_code', '15'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '1'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('number_of_working_hours', '5'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '142'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '153'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '4'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '102'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('head_of_household_flag', 'N'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '29'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '43'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '145'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '52'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('number_of_working_hours', '54'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('number_of_working_hours', '41'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '9'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('number_of_years_spent_in_the_united_states', None), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '110'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '62'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('number_of_working_hours', '86'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('number_of_working_hours', '63'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('relationship_to_head_of_household_code', '1'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('number_of_working_hours', '97'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '14'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '117'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('number_of_working_hours', '40'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '93'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '107'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '101'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('number_of_working_hours', '56'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '19'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('relationship_to_head_of_household_code', '11'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '96'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('number_of_working_hours', '35'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '127'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('number_of_working_hours', '90'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '75'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '155'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '120'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('number_of_working_hours', '28'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('number_of_working_hours', '17'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '1'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '23'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('number_of_years_spent_in_the_united_states', '9'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('number_of_working_hours', '30'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '69'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('number_of_working_hours', '33'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '161'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '71'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('number_of_working_hours', '24'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '11'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('number_of_working_hours', '7'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '123'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '39'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('working_women_full_time_flag', 'Y'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('number_of_working_hours', '79'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '23'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('principal_shopper', 'Y'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '22'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '70'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('language_class_code', '6'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('number_of_working_hours', '96'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '63'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '66'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('relationship_to_head_of_household_code', '3'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '3'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('number_of_working_hours', '88'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '18'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('frequent_moviegoer_code', 'N'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('number_of_working_hours', '92'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '12'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '36'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('number_of_working_hours', '3'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '40'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '38'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '17'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('number_of_working_hours', '9'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '115'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '15'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('working_women_part_time_flag', 'N'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('number_of_working_hours', '81'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '8'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('number_of_working_hours', '45'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '78'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '56'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '65'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '62'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '106'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('nielsen_occupation_code', '7'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '101'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '40'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('nielsen_occupation_code', '4'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '84'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('number_of_working_hours', '91'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('number_of_working_hours', '76'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('number_of_working_hours', '26'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '168'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('number_of_working_hours', '84'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '32'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('origin', '2'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '132'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '19'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('works_outside_of_home_flag', 'N'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('language_class_code', '1'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('number_of_working_hours', '14'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('number_of_working_hours', '44'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '71'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('number_of_working_hours', '11'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '34'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('number_of_years_spent_in_the_united_states', '4'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '22'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '44'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('origin', None), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '119'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '13'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '76'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('number_of_working_hours', '51'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('number_of_working_hours', '94'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('race', None), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('number_of_working_hours', '19'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '160'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '88'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '29'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('origin', '1'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '42'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('education_ranges', '5'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('number_of_working_hours', '85'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '4'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '3'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '96'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '140'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('number_of_working_hours', '67'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('relationship_to_head_of_household_code', '13'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '129'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '67'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '39'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('working_women_full_time_flag', 'N'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '15'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('working_women_part_time_flag', 'Y'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('number_of_working_hours', '25'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '73'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '163'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '98'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '108'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '124'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('number_of_working_hours', '59'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '59'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('number_of_working_hours', '82'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('number_of_working_hours', '1'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '128'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '7'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '25'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '85'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('number_of_working_hours', '12'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '60'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '139'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '77'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('number_of_working_hours', '93'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('number_of_working_hours', '58'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('number_of_working_hours', '74'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '34'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '56'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('nielsen_occupation_code', '5'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '162'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('number_of_working_hours', '60'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '113'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('number_of_working_hours', '61'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '12'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '21'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '7'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('relationship_to_head_of_household_code', '5'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '64'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '58'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('number_of_working_hours', '66'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '95'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('number_of_working_hours', '57'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('visitor_status_code', 'L'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '116'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('number_of_working_hours', '78'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('number_of_working_hours', '42'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '148'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '91'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '123'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('avid_moviegoer_code', 'N'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('number_of_working_hours', '38'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '82'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '47'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('number_of_working_hours', '99'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('nielsen_occupation_code', '0'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '74'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '94'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '28'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '26'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '55'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '105'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '144'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '107'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '87'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('number_of_working_hours', '95'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '76'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '37'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '81'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '165'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '104'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('number_of_working_hours', '20'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('race', '1'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '91'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '126'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('education_ranges', '1'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('number_of_working_hours', '18'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '98'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '135'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '28'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('number_of_working_hours', '73'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('number_of_working_hours', '15'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '109'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '117'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '144'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('principal_shopper', 'N'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '164'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '93'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '30'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('number_of_working_hours', '39'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '67'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '42'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('number_of_working_hours', '4'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '68'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '5'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '121'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('language_class_code', '5'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '136'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('number_of_working_hours', '10'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '58'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('principal_moviegoer_code', 'N'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '66'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('relationship_to_head_of_household_code', '14'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '6'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '63'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('number_of_working_hours', '87'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '52'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('race', '3'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '55'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '43'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '79'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('race', '4'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('number_of_working_hours', '46'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('nielsen_occupation_code', '8'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('number_of_working_hours', '32'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '108'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('nielsen_occupation_code', '1'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '27'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '68'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '20'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('nielsen_occupation_code', '3'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('number_of_working_hours', '83'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('number_of_working_hours', '27'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('number_of_working_hours', '70'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '86'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('relationship_to_head_of_household_code', '8'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '90'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '45'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '25'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '89'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '13'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '110'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('number_of_working_hours', '29'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('relationship_to_head_of_household_code', '7'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '97'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '105'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '49'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '32'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '54'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '104'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('number_of_working_hours', '52'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('number_of_years_spent_in_the_united_states', '1'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('number_of_years_spent_in_the_united_states', '5'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('number_of_working_hours', '75'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '31'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('number_of_years_spent_in_the_united_states', '6'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '5'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('relationship_to_head_of_household_code', '2'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '21'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('number_of_working_hours', '69'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '53'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('number_of_working_hours', '13'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '120'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('relationship_to_head_of_household_code', '6'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('race', '2'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('number_of_working_hours', '6'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '168'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('origin', '9'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '46'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('number_of_working_hours', '48'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '26'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('number_of_working_hours', '21'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('number_of_working_hours', '23'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('relationship_to_head_of_household_code', '9'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '140'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '35'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '99'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '10'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('number_of_working_hours', '53'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '11'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '61'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '130'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '158'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '47'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('number_of_working_hours', '22'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('number_of_years_spent_in_the_united_states', '2'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('race', '99'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('education_ranges', '2'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('avid_moviegoer_code', 'Y'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '27'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '80'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_home', '138'), {'member_attribute_name': 0, 'member_attribute_val': 1})
Row(('internet_usage_work', '31'), {'member_attribute_name': 0, 'member_attribute_val': 1})











here it should convert the result into  

Row(('race', '5'), {'member_attribute_name': 0, 'member_attribute_val': 1})

{'member_attribute_name': 'race', 'member_attr_val': '4,5,2,3,1,99'}
