{'country': 'US', 'attribute_name': 'internet_usage_home', 'name_label': 'Internet Usage Home', 'values': {'97': {'label': '', 'description': ''}, '82': {'label': '', 'description': ''}, '31': {'label': '', 'description': ''}, '24': {'label': '', 'description': ''}, '127': {'label': '', 'description': ''}, '162': {'label': '', 'description': ''}, '145': {'label': '', 'description': ''}, '23': {'label': '', 'description': ''}, '143': {'label': 'Unknown', 'description': 'No information available'}, '166': {'label': '', 'description': ''}, '3': {'label': '', 'description': ''}, '108': {'label': '', 'description': ''}, '59': {'label': '', 'description': ''}, '124': {'label': '', 'description': ''}, '163': {'label': 'Unknown', 'description': 'No information available'}, '2': {'label': '', 'description': ''}, '57': {'label': '', 'description': ''}, '54': {'label': '', 'description': ''}, '94': {'label': '', 'description': ''}, '92': {'label': '', 'description': ''}, '0': {'label': 'The number of hours a person spends on the internet at work or performing work-related activities away from home in a week (000 - 168)', 'description': 'The number of hours a person spends on the internet at work or performing work-related activities away from home in a week (000 - 168)'}, '65': {'label': '', 'description': ''}, '35': {'label': '', 'description': ''}, '110': {'label': '', 'description': ''}, '18': {'label': '', 'description': ''}, '7': {'label': '', 'description': ''}, '96': {'label': '', 'description': ''}, '134': {'label': 'Unknown', 'description': 'No information available'}, '101': {'label': '', 'description': ''}, '52': {'label': '', 'description': ''}, '148': {'label': '', 'description': ''}, '62': {'label': '', 'description': ''}, '20': {'label': '', 'description': ''}, '122': {'label': '', 'description': ''}, '156': {'label': '', 'description': ''}, '25': {'label': '', 'description': ''}, '1': {'label': '', 'description': ''}, '74': {'label': '', 'description': ''}, '118': {'label': '', 'description': ''}, '107': {'label': '', 'description': ''}, '5': {'label': '', 'description': ''}, '121': {'label': 'Unknown', 'description': 'No information available'}, '133': {'label': '', 'description': ''}, '78': {'label': '', 'description': ''}, '155': {'label': '', 'description': ''}, '50': {'label': '', 'description': ''}, '165': {'label': '', 'description': ''}, '125': {'label': '', 'description': ''}, '103': {'label': '', 'description': ''}, '147': {'label': '', 'description': ''}, '164': {'label': '', 'description': ''}, '159': {'label': '', 'description': ''}, '87': {'label': '', 'description': ''}, '128': {'label': '', 'description': ''}, '109': {'label': '', 'description': ''}, '123': {'label': '', 'description': ''}, '136': {'label': '', 'description': ''}, '75': {'label': '', 'description': ''}, '151': {'label': '', 'description': ''}, '30': {'label': '', 'description': ''}, '80': {'label': '', 'description': ''}, '116': {'label': '', 'description': ''}, '129': {'label': '', 'description': ''}, '48': {'label': '', 'description': ''}, '113': {'label': '', 'description': ''}, '53': {'label': '', 'description': ''}, '119': {'label': '', 'description': ''}, '153': {'label': '', 'description': ''}, '64': {'label': '', 'description': ''}, '39': {'label': '', 'description': ''}, '70': {'label': '', 'description': ''}, '168': {'label': '', 'description': ''}, '36': {'label': '', 'description': ''}, '69': {'label': '', 'description': ''}, '77': {'label': '', 'description': ''}, '51': {'label': '', 'description': ''}, '111': {'label': '', 'description': ''}, '84': {'label': '', 'description': ''}, '16': {'label': '', 'description': ''}, '26': {'label': '', 'description': ''}, '42': {'label': '', 'description': ''}, '73': {'label': '', 'description': ''}, '67': {'label': '', 'description': ''}, '105': {'label': '', 'description': ''}, '81': {'label': '', 'description': ''}, '72': {'label': '', 'description': ''}, '152': {'label': '', 'description': ''}, '85': {'label': '', 'description': ''}, '68': {'label': '', 'description': ''}, '106': {'label': '', 'description': ''}, '4': {'label': '', 'description': ''}, '102': {'label': '', 'description': ''}, '89': {'label': '', 'description': ''}, '114': {'label': '', 'description': ''}, '8': {'label': '', 'description': ''}, '11': {'label': '', 'description': ''}, '130': {'label': '', 'description': ''}, '61': {'label': '', 'description': ''}, '158': {'label': 'Unknown', 'description': 'No information available'}, '144': {'label': '', 'description': ''}, '43': {'label': '', 'description': ''}, '55': {'label': '', 'description': ''}, '49': {'label': '', 'description': ''}, '93': {'label': '', 'description': ''}, '100': {'label': '', 'description': ''}, '95': {'label': '', 'description': ''}, '135': {'label': '', 'description': ''}, '160': {'label': '', 'description': ''}, '28': {'label': '', 'description': ''}, '9': {'label': '', 'description': ''}, '150': {'label': '', 'description': ''}, '58': {'label': '', 'description': ''}, '38': {'label': '', 'description': ''}, '139': {'label': 'Unknown', 'description': 'No information available'}, '126': {'label': '', 'description': ''}, '104': {'label': '', 'description': ''}, '10': {'label': '', 'description': ''}, '14': {'label': '', 'description': ''}, '71': {'label': '', 'description': ''}, '115': {'label': '', 'description': ''}, '12': {'label': '', 'description': ''}, '120': {'label': '', 'description': ''}, '22': {'label': '', 'description': ''}, '44': {'label': '', 'description': ''}, '32': {'label': '', 'description': ''}, '60': {'label': '', 'description': ''}, '79': {'label': '', 'description': ''}, '34': {'label': '', 'description': ''}, '91': {'label': '', 'description': ''}, '90': {'label': '', 'description': ''}, '15': {'label': '', 'description': ''}, '157': {'label': '', 'description': ''}, '83': {'label': '', 'description': ''}, '161': {'label': '', 'description': ''}, '37': {'label': '', 'description': ''}, '33': {'label': '', 'description': ''}, '138': {'label': '', 'description': ''}, '88': {'label': '', 'description': ''}, '117': {'label': '', 'description': ''}, '86': {'label': '', 'description': ''}, '66': {'label': '', 'description': ''}, '98': {'label': '', 'description': ''}, '40': {'label': '', 'description': ''}, '45': {'label': '', 'description': ''}, '132': {'label': '', 'description': ''}, '17': {'label': '', 'description': ''}, '99': {'label': '', 'description': ''}, '6': {'label': '', 'description': ''}, '63': {'label': '', 'description': ''}, '29': {'label': '', 'description': ''}, '112': {'label': '', 'description': ''}, '27': {'label': '', 'description': ''}, '47': {'label': '', 'description': ''}, '46': {'label': '', 'description': ''}, '131': {'label': 'Unknown', 'description': 'No information available'}, '21': {'label': '', 'description': ''}, '13': {'label': '', 'description': ''}, '76': {'label': '', 'description': ''}, '41': {'label': '', 'description': ''}, '154': {'label': '', 'description': ''}, '140': {'label': '', 'description': ''}, '56': {'label': '', 'description': ''}, '19': {'label': '', 'description': ''}}}
{'country': 'US', 'attribute_name': 'frequent_moviegoer_code', 'name_label': 'Frequent Moviegoer Code', 'values': {'Y': {'label': 'The person is a frequent moviegoer.', 'description': 'Y= The person is a frequent moviegoer.'}, 'N': {'label': 'The person is not a frequent moviegoer.', 'description': 'N= The person is not a frequent moviegoer.'}}}
{'country': 'US', 'attribute_name': 'nielsen_occupation_code', 'name_label': 'Nielsen Occupation Code', 'values': {'0': {'label': 'Professional/Technical', 'description': '00=Professional/Technical'}, '8': {'label': 'Retired Not Seeking Employment', 'description': '08=Retired Not Seeking Employment'}, '7': {'label': 'Private Household/Laborer', 'description': '07=Private Household/Laborer'}, '3': {'label': 'Farm', 'description': '03=Farm'}, '1': {'label': 'Administrator/Manager', 'description': '01=Administrator/Manager'}, '5': {'label': 'Operatives/Transport', 'description': '05=Operatives/Transport'}, '6': {'label': 'Service Workers', 'description': '06=Service Workers'}, '2': {'label': 'Sales/Clerical', 'description': '02=Sales/Clerical'}, '4': {'label': 'Craftsmen', 'description': '04=Craftsmen'}}}
{'country': 'US', 'attribute_name': 'principal_moviegoer_code', 'name_label': 'Principal Moviegoer Code', 'values': {'Y': {'label': 'The person is a frequent moviegoer.', 'description': 'Y= The person is a frequent moviegoer.'}, 'N': {'label': 'The person is not a frequent moviegoer.', 'description': 'N= The person is not a frequent moviegoer.'}}}
{'country': 'US', 'attribute_name': 'number_of_working_hours', 'name_label': 'Number Of Working Hours', 'values': {'38': {'label': '', 'description': ''}, '15': {'label': '', 'description': ''}, '2': {'label': '', 'description': ''}, '47': {'label': '', 'description': ''}, '77': {'label': '', 'description': ''}, '57': {'label': '', 'description': ''}, '62': {'label': '', 'description': ''}, '21': {'label': '', 'description': ''}, '86': {'label': '', 'description': ''}, '34': {'label': '', 'description': ''}, '68': {'label': '', 'description': ''}, '12': {'label': '', 'description': ''}, '32': {'label': '', 'description': ''}, '71': {'label': '', 'description': ''}, '83': {'label': '', 'description': ''}, '85': {'label': '', 'description': ''}, '16': {'label': '', 'description': ''}, '30': {'label': '', 'description': ''}, '8': {'label': '', 'description': ''}, '80': {'label': '', 'description': ''}, '11': {'label': '', 'description': ''}, '75': {'label': '', 'description': ''}, '52': {'label': '', 'description': ''}, '64': {'label': '', 'description': ''}, '93': {'label': '', 'description': ''}, '61': {'label': '', 'description': ''}, '31': {'label': '', 'description': ''}, '3': {'label': '', 'description': ''}, '97': {'label': '', 'description': ''}, '29': {'label': '', 'description': ''}, '6': {'label': '', 'description': ''}, '89': {'label': '', 'description': ''}, '25': {'label': '', 'description': ''}, '4': {'label': '', 'description': ''}, '91': {'label': '', 'description': ''}, '87': {'label': '', 'description': ''}, '39': {'label': '', 'description': ''}, '41': {'label': '', 'description': ''}, '51': {'label': '', 'description': ''}, '94': {'label': '', 'description': ''}, '73': {'label': '', 'description': ''}, '82': {'label': '', 'description': ''}, '98': {'label': '', 'description': ''}, '13': {'label': '', 'description': ''}, '17': {'label': '', 'description': ''}, '56': {'label': '', 'description': ''}, '48': {'label': '', 'description': ''}, '60': {'label': '', 'description': ''}, '19': {'label': '', 'description': ''}, '58': {'label': '', 'description': ''}, '18': {'label': '', 'description': ''}, '55': {'label': '', 'description': ''}, '5': {'label': '', 'description': ''}, '66': {'label': '', 'description': ''}, '35': {'label': '', 'description': ''}, '26': {'label': '', 'description': ''}, '1': {'label': '', 'description': ''}, '59': {'label': '', 'description': ''}, '50': {'label': '', 'description': ''}, '81': {'label': '', 'description': ''}, '28': {'label': '', 'description': ''}, '44': {'label': '', 'description': ''}, '79': {'label': '', 'description': ''}, '37': {'label': '', 'description': ''}, '72': {'label': '', 'description': ''}, '27': {'label': '', 'description': ''}, '70': {'label': '', 'description': ''}, '7': {'label': '', 'description': ''}, '40': {'label': '', 'description': ''}, '0': {'label': 'The number of hours a week the person works (00-99)', 'description': 'The number of hours a week the person works (00-99)'}, '36': {'label': '', 'description': ''}, '65': {'label': '', 'description': ''}, '96': {'label': '', 'description': ''}, '67': {'label': '', 'description': ''}, '24': {'label': '', 'description': ''}, '43': {'label': '', 'description': ''}, '23': {'label': '', 'description': ''}, '54': {'label': '', 'description': ''}, '90': {'label': '', 'description': ''}, '78': {'label': '', 'description': ''}, '74': {'label': '', 'description': ''}, '92': {'label': '', 'description': ''}, '46': {'label': '', 'description': ''}, '45': {'label': '', 'description': ''}, '84': {'label': '', 'description': ''}, '76': {'label': '', 'description': ''}, '95': {'label': '', 'description': ''}, '9': {'label': '', 'description': ''}, '88': {'label': '', 'description': ''}, '53': {'label': '', 'description': ''}, '42': {'label': '', 'description': ''}, '33': {'label': '', 'description': ''}, '20': {'label': '', 'description': ''}, '49': {'label': '', 'description': ''}, '99': {'label': '', 'description': ''}, '69': {'label': '', 'description': ''}, '22': {'label': '', 'description': ''}, '63': {'label': '', 'description': ''}, '14': {'label': '', 'description': ''}, '10': {'label': '', 'description': ''}}}
{'country': 'US', 'attribute_name': 'education_ranges', 'name_label': 'Education Ranges', 'values': {'3': {'label': 'High School graduate (i.e., 12 years)', 'description': '3 = High School graduate (i.e., 12 years)'}, '1': {'label': 'grade school (i.e., 0-8 years)', 'description': '1 = grade school (i.e., 0-8 years)'}, '4': {'label': 'Some college (i.e., 1-3 years of college)', 'description': '4 = Some college (i.e., 1-3 years of college)'}, '2': {'label': 'Some High School (i.e., 9-11 years)', 'description': '2 = Some High School (i.e., 9-11 years)'}, '5': {'label': 'College Graduate (i.e., 4+ years of college)', 'description': '5 = College Graduate (i.e., 4+ years of college)'}}}
{'country': 'US', 'attribute_name': 'lady_of_household_flag', 'name_label': 'Lady Of Household Flag', 'values': {'Y': {'label': '', 'description': ''}, 'N': {'label': '', 'description': ''}}}
{'country': 'US', 'attribute_name': 'working_women_full_time_flag', 'name_label': 'Working Women Full Time Flag', 'values': {'Y': {'label': 'This person is a full time working woman', 'description': 'Y = This person is a full time working woman'}, 'N': {'label': 'This person is not a full time working woman', 'description': 'N = This person is not a full time working woman'}}}
{'country': 'US', 'attribute_name': 'visitor_status_code', 'name_label': 'Visitor Status Code', 'values': {'': {'label': 'household member.', 'description': 'Blank = household member.'}, 'L': {'label': 'long-term visitor', 'description': 'L = long-term visitor'}}}
{'country': 'US', 'attribute_name': 'race', 'name_label': 'Race', 'values': {'3': {'label': 'Black', 'description': '03 = Black'}, '1': {'label': 'Other Race', 'description': '01 = Other Race'}, '2': {'label': 'White', 'description': '02 = White'}, '4': {'label': 'Asian or Pacific Islander', 'description': '04 = Asian or Pacific Islander'}, '5': {'label': 'American Indian/Alaska Native', 'description': '05 = American Indian/Alaska Native'}, '99': {'label': 'Unknown', 'description': '99 = Unknown'}}}
{'country': 'US', 'attribute_name': 'internet_usage_work', 'name_label': 'Internet Usage Work', 'values': {'140': {'label': '', 'description': ''}, '119': {'label': '', 'description': ''}, '73': {'label': '', 'description': ''}, '43': {'label': '', 'description': ''}, '112': {'label': '', 'description': ''}, '71': {'label': 'Unknown', 'description': 'No information available'}, '123': {'label': '', 'description': ''}, '23': {'label': '', 'description': ''}, '104': {'label': '', 'description': ''}, '68': {'label': '', 'description': ''}, '168': {'label': 'Unknown', 'description': 'No information available'}, '64': {'label': '', 'description': ''}, '29': {'label': '', 'description': ''}, '62': {'label': '', 'description': ''}, '0': {'label': '', 'description': ''}, '70': {'label': '', 'description': ''}, '77': {'label': '', 'description': ''}, '157': {'label': '', 'description': ''}, '66': {'label': '', 'description': ''}, '101': {'label': '', 'description': ''}, '144': {'label': 'Unknown', 'description': 'No information available'}, '117': {'label': '', 'description': ''}, '120': {'label': '', 'description': ''}, '34': {'label': '', 'description': ''}, '134': {'label': '', 'description': ''}, '145': {'label': 'Unknown', 'description': 'No information available'}, '128': {'label': '', 'description': ''}, '79': {'label': '', 'description': ''}, '102': {'label': '', 'description': ''}, '98': {'label': '', 'description': ''}, '51': {'label': '', 'description': ''}, '67': {'label': '', 'description': ''}, '115': {'label': 'Unknown', 'description': 'No information available'}, '46': {'label': '', 'description': ''}, '59': {'label': '', 'description': ''}, '1': {'label': '', 'description': ''}, '96': {'label': '', 'description': ''}, '14': {'label': '', 'description': ''}, '100': {'label': '', 'description': ''}, '65': {'label': '', 'description': ''}, '50': {'label': '', 'description': ''}, '22': {'label': '', 'description': ''}, '28': {'label': '', 'description': ''}, '13': {'label': '', 'description': ''}, '86': {'label': '', 'description': ''}, '84': {'label': '', 'description': ''}, '126': {'label': '', 'description': ''}, '2': {'label': '', 'description': ''}, '48': {'label': '', 'description': ''}, '94': {'label': '', 'description': ''}, '76': {'label': '', 'description': ''}, '91': {'label': '', 'description': ''}, '110': {'label': '', 'description': ''}, '57': {'label': '', 'description': ''}, '113': {'label': 'Unknown', 'description': 'No information available'}, '90': {'label': '', 'description': ''}, '33': {'label': '', 'description': ''}, '52': {'label': '', 'description': ''}, '17': {'label': '', 'description': ''}, '45': {'label': '', 'description': ''}, '32': {'label': '', 'description': ''}, '85': {'label': '', 'description': ''}, '30': {'label': '', 'description': ''}, '99': {'label': 'Unknown', 'description': 'No information available'}, '44': {'label': '', 'description': ''}, '160': {'label': 'Unknown', 'description': 'No information available'}, '75': {'label': '', 'description': ''}, '20': {'label': '', 'description': ''}, '105': {'label': '', 'description': ''}, '55': {'label': '', 'description': ''}, '142': {'label': 'Unknown', 'description': 'No information available'}, '60': {'label': '', 'description': ''}, '49': {'label': '', 'description': ''}, '18': {'label': '', 'description': ''}, '21': {'label': '', 'description': ''}, '58': {'label': '', 'description': ''}, '54': {'label': '', 'description': ''}, '4': {'label': '', 'description': ''}, '11': {'label': '', 'description': ''}, '93': {'label': '', 'description': ''}, '24': {'label': '', 'description': ''}, '41': {'label': '', 'description': ''}, '56': {'label': '', 'description': ''}, '5': {'label': '', 'description': ''}, '82': {'label': '', 'description': ''}, '12': {'label': '', 'description': ''}, '61': {'label': '', 'description': ''}, '108': {'label': 'Unknown', 'description': 'No information available'}, '27': {'label': '', 'description': ''}, '80': {'label': '', 'description': ''}, '74': {'label': '', 'description': ''}, '81': {'label': '', 'description': ''}, '37': {'label': '', 'description': ''}, '7': {'label': '', 'description': ''}, '25': {'label': '', 'description': ''}, '107': {'label': '', 'description': ''}, '8': {'label': '', 'description': ''}, '78': {'label': '', 'description': ''}, '38': {'label': '', 'description': ''}, '150': {'label': '', 'description': ''}, '6': {'label': '', 'description': ''}, '3': {'label': '', 'description': ''}, '72': {'label': '', 'description': ''}, '63': {'label': '', 'description': ''}, '95': {'label': '', 'description': ''}, '10': {'label': '', 'description': ''}, '36': {'label': '', 'description': ''}, '19': {'label': '', 'description': ''}, '39': {'label': '', 'description': ''}, '125': {'label': '', 'description': ''}, '31': {'label': '', 'description': ''}, '42': {'label': '', 'description': ''}, '9': {'label': '', 'description': ''}, '15': {'label': '', 'description': ''}, '16': {'label': '', 'description': ''}, '26': {'label': '', 'description': ''}, '92': {'label': '', 'description': ''}, '47': {'label': '', 'description': ''}, '53': {'label': '', 'description': ''}, '116': {'label': 'Unknown', 'description': 'No information available'}, '40': {'label': '', 'description': ''}, '35': {'label': '', 'description': ''}, '165': {'label': '', 'description': ''}}}
{'country': 'US', 'attribute_name': 'avid_moviegoer_code', 'name_label': 'Avid Moviegoer Code', 'values': {'N': {'label': 'The person is not an avid moviegoer', 'description': 'N = The person is not an avid moviegoer'}, 'Y': {'label': 'The person is an avid moviegoer.', 'description': 'Y = The person is an avid moviegoer.'}}}
{'country': 'US', 'attribute_name': 'relationship_to_head_of_household_code', 'name_label': 'Relationship To Head Of Household Code', 'values': {'4': {'label': '04 Spouse Not Designated As HOH', 'description': '04 Spouse Not Designated As HOH'}, '7': {'label': '07 Other Relative', 'description': '07 Other Relative'}, '13': {'label': 'Unknown', 'description': 'No information available'}, '2': {'label': '02 LOH', 'description': '02 LOH'}, '15': {'label': 'Unmarried Partner - Male', 'description': 'Unmarried Partner - Male'}, '8': {'label': '08 Non-Relative Household Member', 'description': '08 Non-Relative Household Member'}, '14': {'label': 'Unmarried Partner - Female', 'description': 'Unmarried Partner - Female'}, '10': {'label': '10 Long Term Visitor', 'description': '10 Long Term Visitor'}, '6': {'label': '06 Daughter', 'description': '06 Daughter'}, '9': {'label': '09 Partner Living With But Not Married To', 'description': '09 Partner Living With But Not Married To'}, '3': {'label': '03 Wife Not Designated As HOH', 'description': '03 Wife Not Designated As HOH'}, '5': {'label': '05 Son', 'description': '05 Son'}, '11': {'label': '11 LOH as HOH', 'description': '11 LOH as HOH'}, '1': {'label': '01 HOH', 'description': '01 HOH'}}}
{'country': 'US', 'attribute_name': 'number_of_years_spent_in_the_united_states', 'name_label': 'Number Of Years Spent In The United States', 'values': {'9': {'label': 'Unknown', 'description': '9 = Unknown'}, '4': {'label': '15 to 20 Years', 'description': '4 = 15 to 20 Years'}, '6': {'label': 'Born in the USA', 'description': '6 = Born in the USA'}, '1': {'label': 'Less than 5 Years', 'description': '1 = Less than 5 Years'}, '5': {'label': 'Over 20 Years', 'description': '5 = Over 20 Years'}, '3': {'label': '10 to 15 Years', 'description': '3 = 10 to 15 Years'}, '2': {'label': '5 to 10 Years', 'description': '2 = 5 to 10 Years'}}}
{'country': 'US', 'attribute_name': 'origin', 'name_label': 'Origin', 'values': {'1': {'label': 'Non-Hispanic', 'description': '1 = Non-Hispanic'}, '2': {'label': 'Hispanic', 'description': '2 = Hispanic'}, '9': {'label': 'Unknown', 'description': '9 = Unknown'}}}
{'country': 'US', 'attribute_name': 'principal_shopper', 'name_label': 'Principal Shopper', 'values': {'N': {'label': 'This person is not the principal grocery shopper in the household', 'description': 'N = This person is not the principal grocery shopper in the household'}, 'Y': {'label': 'This person is the principal grocery shopper in the household.', 'description': 'Y = This person is the principal grocery shopper in the household.'}}}
{'country': 'US', 'attribute_name': 'language_class_code', 'name_label': 'Language Class Code', 'values': {'5': {'label': 'English Only', 'description': '5 = English Only'}, '6': {'label': 'Unknown', 'description': '6 = Unknown'}, '3': {'label': 'Bilingual', 'description': '3 = Bilingual'}, '2': {'label': 'Mostly Spanish', 'description': '2 = Mostly Spanish'}, '4': {'label': 'Mostly English', 'description': '4 = Mostly English'}, '1': {'label': 'Spanish Only', 'description': '1 = Spanish Only'}}}
{'country': 'US', 'attribute_name': 'head_of_household_flag', 'name_label': 'Head Of Household Flag', 'values': {'Y': {'label': 'The person is the Head of Household', 'description': 'Y = The person is the Head of Household'}, 'N': {'label': 'The person is not the Head of Household', 'description': 'N = The person is not the Head of Household'}}}
{'country': 'US', 'attribute_name': 'working_women_part_time_flag', 'name_label': 'Working Women Part Time Flag', 'values': {'N': {'label': 'This person is not a part time working woman', 'description': 'N = This person is not a part time working woman'}, 'Y': {'label': 'This person is a part time working woman', 'description': 'Y = This person is a part time working woman'}}}
{'country': 'US', 'attribute_name': 'works_outside_of_home_flag', 'name_label': 'Works Outside Of Home Flag', 'values': {'Y': {'label': 'The person works outside of the home', 'description': 'Y = The person works outside of the home'}, '': {'label': 'Blank for Long Term Visitors', 'description': 'Blank for Long Term Visitors'}, 'N': {'label': 'The person does not work outside of the home', 'description': 'N = The person does not work outside of the home'}}}


from google.cloud import bigquery
project_id = 'ltvo-dswb-prod-c423'
client = bigquery.Client(project=project_id)
import re
query = """
SELECT member_attribute_name, STRING_AGG(DISTINCT member_attribute_val) as member_attr_val 
 FROM `ltvo-datalake-prod-dfd5.f_ltvo_us.member_attribute_dim` 
 WHERE record_date < "2023-10-4"
 AND member_attribute_name NOT IN ("monthly_unified_weight","hh_quarterly_unified_weight","quarterly_unified_weight","hh_monthly_unified_weight","hh_weight_qty","age_gender_building_block_code","hh_weekly_unified_weight","weekly_unified_weight")
GROUP BY member_attribute_name
"""

query_job=client.query(query)

results=query_job.result()
output=[]
for row in results:
    output.append({
        "member_attribute_name":row[0],
        "member_attribute_value":row[1]
    })   
import csv
attribute_info={}
with open('attributes.csv',newline='') as csvfile:
    csv_reader=csv.DictReader(csvfile)
    for row in csv_reader:
        country_code=row['country_code']
        attribute_name= row['attribute_name']
        attribute_value=row['attribute_value']
        value_label=row['value_label']
        if country_code and attribute_name:
            if attribute_value:
                attribute_info.setdefault(country_code,{})
                attribute_info[country_code].setdefault(attribute_name,{})
                attribute_info[country_code][attribute_name][attribute_value]={
                    "label":value_label,
                    "description":value_label
                }
            else:
                attribute_info.setdefault(country_code,{})
                attribute_info[country_code].setdefault(attribute_name,{})
                attribute_info[country_code][attribute_name][""]={
                    "label":value_label,
                    'description':value_label
                }
        else:
            print(f"Country{country_code} doesnot exist")
final_attributes={}
final_output=[]
for res in output:
    attribute_name=res["member_attribute_name"]
    #print(attribute_name)
    mem_val=res["member_attribute_value"]
    #print(mem_val)
    values={}
    for value in mem_val.split(","):
        if value in attribute_info.get("US",{}).get(attribute_name,{}):
            info=attribute_info["US"][attribute_name][value]
            #print(info)
            label=info.get('label','Unknown')
            match = re.search(r"=\s*(.*)", label)
            if match:
                extracted_label = match.group(1)
            else:
                extracted_label=info.get('label',"Unknown")
            description=info.get('description','Unknown')
        else:
                extracted_label='Unknown'
                description='No information available'
        values[value]={'label':extracted_label,'description':description}
        final_attributes["country"]="US"
        final_attributes["attribute_name"]=attribute_name
        final_attributes["name_label"]=attribute_name.replace("_", " ").title()
        final_attributes["values"]=values
    final_output.append(final_attributes)
    print(final_attributes)
#print(final_output)
# import json
# with open('file1.json', 'w') as f:
#     # Define the data to be written
#     data = final_output
#     # Use a for loop to write each line of data to the file
#     for line in data:
#         json.dump(line,f)
#         # Optionally, print the data as it is written to the file
#         #print(line)














































from google.cloud import bigquery
project_id = 'ltvo-dswb-prod-c423'
client = bigquery.Client(project=project_id)
import re

query = """
SELECT member_attribute_name, STRING_AGG(DISTINCT member_attribute_val) as member_attr_val 
 FROM `ltvo-datalake-prod-dfd5.f_ltvo_us.member_attribute_dim` 
 WHERE record_date < "2023-10-4"
 AND member_attribute_name NOT IN ("monthly_unified_weight","hh_quarterly_unified_weight","quarterly_unified_weight","hh_monthly_unified_weight","hh_weight_qty","age_gender_building_block_code","hh_weekly_unified_weight","weekly_unified_weight")
GROUP BY member_attribute_name
"""

query_job=client.query(query)

results=query_job.result()
output=[]
for row in results:
    output.append({
        "member_attribute_name":row[0],
        "member_attribute_value":row[1]
    })   
import csv
attribute_info={}
with open('attributes.csv',newline='') as csvfile:
    csv_reader=csv.DictReader(csvfile)
    for row in csv_reader:
        country_code=row['country_code']
        attribute_name= row['attribute_name']
        attribute_value=row['attribute_value']
        value_label=row['value_label']
        if country_code and attribute_name:
            if attribute_value:
                attribute_info.setdefault(country_code,{})
                attribute_info[country_code].setdefault(attribute_name,{})
                attribute_info[country_code][attribute_name][attribute_value]={
                    "label":value_label,
                    "description":value_label
                }
            else:
                attribute_info.setdefault(country_code,{})
                attribute_info[country_code].setdefault(attribute_name,{})
                attribute_info[country_code][attribute_name][""]={
                    "label":value_label,
                    'description':value_label
                }
        else:
            print(f"Country{country_code} doesnot exist")
final_output=[]
seen_attributes=set()
for res in output:
    attribute_name=res["member_attribute_name"]
    #print(attribute_name)
    mem_val=res["member_attribute_value"]
    #print(mem_val)
    values={}
    final_attributes={}
    for value in mem_val.split(","):
        if value in attribute_info.get("US",{}).get(attribute_name,{}):
            info=attribute_info["US"][attribute_name][value]
            #print(info)
            label=info.get('label','Unknown')
            match = re.search(r"=\s*(.*)", label)
            if match:
                extracted_label = match.group(1)
            else:
                extracted_label=info.get('label',"Unknown")
            description=info.get('description','Unknown')
        else:
                extracted_label='Unknown'
                description='No information available'
        values[value]={'label':extracted_label,'description':description}
        final_attributes["country"]="US"
        final_attributes["attribute_name"]=attribute_name
        final_attributes["name_label"]=attribute_name.replace("_", " ").title()
        final_attributes["values"]=values
        attributes_key=(final_attributes["country"],final_attributes["attribute_name"])
        if attributes_key not in seen_attributes:
            seen_attributes.add(attributes_key)
            final_output.append(final_attributes)
print(final_output)

# import json
# with open('file1.json', 'w') as f:
#     # Define the data to be written
#     data = final_output
#     # Use a for loop to write each line of data to the file
#     for line in data:
#         json.dump(line,f)
#         # Optionally, print the data as it is written to the file
#         #print(line)
